<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>MIRS2405-ELEC-0002 MIRS2405 エレクトロニクス開発報告書</title>
<link rel=stylesheet href="../../style.css" type="text/css">
<link rel="shortcut icon" href="../../gullc_rogo.jpg" />
<script>
    setInterval("elm=document.getElementById('izutani');if(elm.style.visibility=='visible'){elm.style.visibility='hidden';}else{elm.style.visibility='visible';}",10000)
</script>

</head>

<body bgcolor="#000000" text="#ff00ff" link="#ff0000" vlink="#ffff00" alink="#0000ff">

    <img src="../../gullc_rogo.jpg" width="100">

<table class="table010">
<tr>
<th>名称</th>
<td class="title">MIRS2405 エレクトロニクス開発報告書</td>
</tr>
<tr>
<th>番号</th>
<td class="title">MIRS2405-ELEC-0002</td>
</tr>
</table>
<br>

<table class="table010">
<tr>
<th>版数</th>
<th>最終更新日</th>
<th>作成</th>
<th>承認</th>
<th>改訂記事</th>
</tr>
<tr>
    <td>A01</td>
    <td>2024.11.18</td>
    <td>宇佐見祥</td>
    <td></td>
    <td>初版</td>
</tr>
<tr>
    <td>A02</td>
    <td>2024.12.10</td>
    <td>宇佐見祥</td>
    <td></td>
    <td>主回路モジュール項の追加とゲート基板画像の差し替え</td>
</tr>
<tr>
    <td>A03</td>
    <td>2024.01.31</td>
    <td>宇佐見祥</td>
    <td></td>
    <td>試験結果の追記</td>
</tr>
</table>

<br>

<h3>目次</h3>
    <ul>
        <li><a href = "#elec2">1. はじめに</a><br> </li>
        <li><a href = "#elec1">2.基板の製作手順</a><br></li>
        <li><a href = "#elec3">3. サーボモータ電源基板</a><br></li>
        <li><a href = "#elec4">4. PWM・ゲートドライブ基板</a><br></li>
        <li><a href = "#elec5">5.電圧測定基板</a><br></li>
        <li><a href = "#elec6">6.主回路モジュール</a><br></li>
        <li><a href = "#elec7">7.電源系回路の機体への固定</a><br></li>
        <li><a href = "#elec8">8.Raspberry Pi pico用基板</a><br></li>
        <li><a href = "#elec9">9.Arduino用基板</a><br></li>
        <li><a href = "#elec11">11.総括</a><br></li>
    </ul>

<br>
<h2><a name = elec1>1.はじめに</a></h2>
本ドキュメントはMIRS2405 𝔊𝔘𝔏𝔏ℭのエレクトロニクス開発報告書である。<br>
<br>

<h2><a name = elec2>2.基板の製作手順</a></h2>
基板の製作にはKicadを用いた。<br>
先ずは回路図からPCBのパターンを作成する。<br>
PCBパターンが完成したらガーバーファイル(裏面の銅箔部分データと外形データ)及びドリルファイルを出力する。<br>
出力されたファイルを基板加工機に移し、加工を始める。<br>
基板加工機は3台あるうちの真ん中にあるミッツ製のものを使用した。<br>
ただし原点合わせや加工穴深さの設定、工具データの設定等が非常に煩雑だった。<br>
基板加工機の使用方法は技術調査書へ。<br>
***URL***<br>
使用したファイルはtable.1より参照。
<center>
    table.1 加工データファイル<br>
    <table class="table010">
        <tr>
            <th>ファイル</th>
            <th>種類</th>
            <th>詳細</th>
        </tr>
        <tr>
            <td><a href="../files/SRV_PCB/gbr/MIRS2405_ServoDCDC-B_Cu.gbr">MIRS2405_ServoDCDC-B_Cu.gbr</a></td>
            <td>ガーバー</td>
            <td>サーボ電源基板の裏面銅箔部ガーバーデータ</td>
        </tr> 
        <tr>
            <td><a href="../files/SRV_PCB/gbr/MIRS2405_ServoDCDC-Edge_Cuts.gbr">MIRS2405_ServoDCDC-Edge_Cuts.gbr</a></td>
            <td>ガーバー</td>
            <td>サーボ電源基板の外形線ガーバーデータ</td>
        </tr>
        <tr>
            <td><a href="../files/SRV_PCB/drl/MIRS2405_ServoDCDC-PTH.drl">MIRS2405_ServoDCDC-PTH.drl</a></td>
            <td>ドリル</td>
            <td>サーボ電源基板のドリルデータ</td>
        </tr>

        <tr>
            <td><a href="../files/GDC_PCB/gbr/MIRS2405_PWM_GD-B_Cu.gbr">MIRS2405_PWM_GD-B_Cu.gbr</a></td>
            <td>ガーバー</td>
            <td>PWM・ゲートドライブ基板の裏面銅箔部ガーバーデータ</td>
        </tr> 
        <tr>
            <td><a href="../files/GDC_PCB/gbr/MIRS2405_PWM_GD-Edge_Cuts.gbr">MIRS2405_PWM_GD-Edge_Cuts.gbr</a></td>
            <td>ガーバー</td>
            <td>PWM・ゲートドライブ基板の外形線ガーバーデータ</td>
        </tr>
        <tr>
            <td><a href="../files/GDC_PCB/drl/MIRS2405_PWM_GD-PTH.drl">MIRS2405_PWM_GD-PTH.drl</a></td>
            <td>ドリル</td>
            <td>PWM・ゲートドライブ基板のドリルデータ</td>
        </tr>

        <tr>
            <td><a href="../files/OVD_PCB/gbr/MIRS2405_OVD_pcb-B_Cu.gbr">MIRS2405_OVD_pcb-B_Cu.gbr</a></td>
            <td>ガーバー</td>
            <td>電圧測定基板の裏面銅箔部ガーバーデータ</td>
        </tr> 
        <tr>
            <td><a href="../files/OVD_PCB/gbr/MIRS2405_OVD_pcb-Edge_Cuts.gbr">MIRS2405_OVD_pcb-Edge_Cuts.gbr</a></td>
            <td>ガーバー</td>
            <td>電圧測定基板の外形線ガーバーデータ</td>
        </tr>
        <tr>
            <td><a href="../files/OVD_PCB/drl/MIRS2405_OVD_pcb-PTH.drl">MIRS2405_OVD_pcb-PTH.drl</a></td>
            <td>ドリル</td>
            <td>電圧測定基板のドリルデータ</td>
        </tr>
    </table>
</center>
<br>


<h2><a name = elec3>3.サーボモータ電源基板</a></h2>
製作した基板をfig.1, fig.2に示す。<br>
<br>
<center>
    <img src="../picture/サーボモータ電源回路_表面.jpg" width="500"><br>
    fig.1 サーボモータ電源回路　表面<br><br>
    <img src="../picture/サーボモータ電源回路_裏面.jpg" width="500"><br>
    fig.2 サーボモータ電源回路　裏面<br><br>
</center>
<br>
バッテリー入力および電源出力はXT60コネクタを使用した。<br>
両面生基板を加工したが、表面は導通させないためヤスリで削った。<br>
単体試験の結果はtable.2に示す。<br>
<center>
    table.2 サーボモータ電源回路 単体試験結果<br>
    <table class="table010">
        <tr>
            <th>試験内容</th>
            <th>合格基準</th>
            <th>試験結果</th>
            <th>合否判断</th>
        </tr>
        <tr>
            <td>出力電圧</td>
            <td>出力電圧が7.0~7.4V以内に収まっていること。</td>
            <td>7.2V程度の出力だった。</td>
            <td>合格</td>
        </tr> 
    </table>
</center>

<br>
<h2><a name = elec4>4.PWM・ゲートドライブ基板</a></h2>
製作した基板をfig.3, fig.4に示す。<br>
<br>
<center>
    <img src="../picture/PWM基板_表面.jpg" width="500"><br>
    fig.3 PWM・ゲートドライブ基板　表面<br><br>
    <img src="../picture/PWM基板_裏面.jpg" width="500"><br>
    fig.4 PWM・ゲートドライブ基板　裏面<br><br>
</center>
基板上面右側の5穴,3穴は、ほかのデバイスとSPIまたはI2Cにて通信するための準備として加工した部分である。<br>
現在はPWM基板と他のマイコン間での通信はしない設計のため、XHコネクタは未実装としている。<br>
サーボ電源基板と同じくヤスリで削った。<br>
四隅に銅箔部が残っているが回路に影響はしないためこのままとしている。<br>
基板単体での動作に問題はなかったが、モーターなどを接続して動作させると突入電流による電圧降下によって<br>
電源制御マイコンにリセットがかかることが分かった。そのため入力側のXT60コネクタにコンデンサ(470μF,50V)を接続することで問題を解消している。<br>
単体試験の結果はtable.3に示す。<br>
<center>
    table.3 PWM・ゲートドライブ基板 単体試験結果<br>
    <table class="table010">
        <tr>
            <th>試験内容</th>
            <th>合格基準</th>
            <th>試験結果</th>
            <th>合否判断</th>
        </tr>
        <tr>
            <td>ゲート信号のチェック</td>
            <td>MOSFETが正常にターンオン・ターンオフできること。</td>
            <td>正常にターンオン・ターンオフできることが確認できた。</td>
            <td>合格</td>
        </tr>
        <tr>
            <td>主回路の電圧測定回路</td>
            <td>電圧を正常に読み取ることができること。</td>
            <td>最大±0.2V程度の誤差で読み取ることができた。</td>
            <td>合格</td>
        </tr>
        <tr>
            <td>電圧のPI制御</td>
            <td>出力電圧を12Vで維持できること。</td>
            <td>制御を正常に行うことができた。</td>
            <td>合格</td>
        </tr>
    </table>
</center>

<h2><a name = elec5>5.電圧測定基板</a></h2>
製作した基板をfig.5, fig.6に示す。<br>
<br>
<center>
    <img src="../picture/電圧測定基板_表面.jpg" width="300"><br>
    fig.5 電圧測定基板　表面<br><br>
    <img src="../picture/電圧測定基板_裏面.jpg" width="300"><br>
    fig.6 電圧測定基板　裏面<br><br>
</center>


<h2><a name = elec6>6.主回路モジュール</a></h2>
製作した基板をfig.7,fig8に示す。<br>
<br>
<center>
    <img src="../picture/主回路モジュール前面.jpg" width="500"><br>
    fig.7 主回路モジュール前面<br><br>
    <img src="../picture/主回路モジュール後面.jpg" width="500"><br>
    fig.8 主回路モジュール後面<br><br>
</center>

<h2><a name = elec7>7.電源系回路の機体への固定</a></h2>
製作した回路はロボットの左側のスペースに固定した。固定の様子をfig.9, fig10に示す。<br>
<br>
<center>
    <img src="../picture/MD段.jpg" width="500"><br>
    fig.9 固定の様子(上)<br><br>
    <img src="../picture/左側回路.jpg" height="500"><br>
    fig.10 固定の様子(下)<br><br>
</center>

<h2><a name = elec8>8.Raspberry Pi pico用基板</a></h2>
基板の外見をfig.11に示す。<br>
<center>
    <img src="../picture/ラズピコ基板.png" width="500"><br>
    fig.11 固定の様子(上)<br><br>
</center>
基板加工のミスで一部削れていない部分があったため、リューターを用いて削った。<br>
<br>

<h2><a name = elec9>9.Arduino用基板</a></h2>
基板の外見をfig.12に示す。<br>
<center>
    <img src="../picture/Arduino基板.png" width="500"><br>
    fig.12 固定の様子(上)<br><br>
</center>

<h2><a name = elec10>10.電源回路制御プログラム</a></h2>
電源回路の制御にはPICマイコン(PIC16F1938)を使用している。<br>
マイコンのピン配置をfig.13に示す。<br>
<center>
    <img src="../picture/PICピン.png" width="250"><br>
    fig.13 ピン配置<br><br>
</center>
PWM周波数は15.625kHzとしている。プログラムは以下のURLに示す。<br>
<address>
    <a href="https://www2.denshi.numazu-ct.ac.jp/mirsdoc2/mirs2405/elec/files/MIRS step down converter.X.zip" target="_self">電源制御プログラム</a>
</address>


<h2><a name = elec11>11.総括</a></h2>
モータを回転させたときの電圧降下を考慮しておらず、部品の追加が必要になってしまった。<br>
メカとの連携不足で配線スペースに余裕がなく、配線長も無駄に長くなってしまった。<br>
各パート間での連携がとても大切だと感じた。<br>

<br><br><br>


<hr>

<address>
    <a href="https://www2.denshi.numazu-ct.ac.jp/mirsdoc2/mirs2405/" target="_self">MIRS2405ドキュメント管理台帳へ</a>
</address>


</BODY></html>